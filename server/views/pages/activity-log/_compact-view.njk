{% set queryParams = 'category=' + category + '&view=default&requirement=' + requirement + '&' + filters.queryStr + '&page=' + page %}
{% set link = '/case/' + crn + '/activity/' + entry.id + '?back=' + url %}
{% if entry.isAppointment %}
      {% set link = '/case/' + crn + '/appointments/appointment/' + entry.id + '/manage?back=' + url %}
{% elif entry.esupervisionId %}
      {% set link = '/case/' + crn + '/appointments/' + entry.esupervisionId + '/check-in/update?back=' + url %}
{% endif %}

<table class="govuk-table govuk-!-margin-top-4">
  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th class="govuk-table__header" style="width: 200px">Date</th>
      <th class="govuk-table__header">Activity</th>
    </tr>
  </thead>
  <tbody class="govuk-table__body">
    {% for entry in entries %}
      {% set lastDate = lastEntry.startDateTime | compactActivityLogDate %}
      {% set thisDate = entry.startDateTime | compactActivityLogDate %}
      {% if lastDate != thisDate %}
      </td>
    </tr>
    <tr class="govuk-table__row">
      <td class="govuk-table__cell">{{ thisDate }}</td>
      <td class="govuk-table__cell">
        <ul class="govuk-list govuk-!-margin-bottom-0 app-activity-log-day-items">
        {% endif %}
        <li>
          {% if entry.isSystemContact === true and entry.isAppointment === false and entry.isCommunication === false and not entry.esupervisionId %}
            <div class="govuk-hint govuk-!-margin-bottom-1">
              <a href="{{ link }}" class="app-!-inherit-colour">{{ entry.type | toSentenceCase }}
                <span class="govuk-visually-hidden"> on {{ thisDate }}</span></a>
            </div>
          {% elif flags.enableESuperVision === true or not entry.esupervisionId %}
            {% include "./_compact-timeline-entry.njk" %}
          {% endif %}
        </li>
        {% set lastEntry = entry %}
      {% endfor %}
    </ul>
  </td>
</tr>
</tbody>
</table>
