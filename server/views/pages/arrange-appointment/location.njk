{% extends "../_form.njk" %}
{% set title = "Pick a location for this appointment" %}

{% set backLink = backLink | default('/case/' + crn + '/arrange-appointment/' + id + '/attendance?back=attendance') %}

{% block heading %}{% endblock %}
{% block form %}
  {% set locationItems = [] %}
  {% for location in userLocations %}
    {% set locationItems = (locationItems.push({
      text: location.description | convertToTitleCase,
      value: location.code,
      attributes: {
        'data-qa': 'locationOption'
      }
    }), locationItems) %}
  {% endfor %}
  {% if userLocations.length > 0 %}
    {% set locationItems = (locationItems.push({divider: 'or'}), locationItems) %}
  {% endif %}
  {% set locationItems = (locationItems.push({text: 'The location Iâ€™m looking for is not in this list', value: 'LOCATION_NOT_IN_LIST'}), locationItems) %}
  {% if not appointment.type.isLocationRequired %}
    {% set locationItems = (locationItems.push({text: 'I do not need to pick a location', value: 'NO_LOCATION_REQUIRED'}), locationItems) %}
  {% endif %}

  {{ govukRadios({
    fieldset: {
      legend: {
        html: '<span data-qa="pageHeading">' + title | safe + '</span>',
        classes: "govuk-fieldset__legend--l govuk-!-margin-bottom-6",
        isPageHeading: false
      },
      attributes: {
        'data-qa': 'locationCode'
      }
    },
    items: locationItems
   } | decorateFormAttributes(['appointments', crn, id, 'user', 'locationCode'])) }}
{% endblock %}